name: Weekly README Metrics

on:
  schedule:
    # Every Monday at 00:00 UTC
    - cron: "0 0 * * 1"
  workflow_dispatch:

permissions:
  contents: write

jobs:
  generate:
    runs-on: ubuntu-latest

    steps:
      # Generates SVGs directly into the repository via GitHub API.
      - name: Generate activity card
        uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN || github.token }}
          user: javier25arroyo
          template: classic
          filename: assets/github-activity.svg
          base: header, activity, community, repositories, metadata
          config_timezone: America/Costa_Rica
          plugin_isocalendar: yes
          plugin_isocalendar_duration: half-year

      - name: Generate achievements card
        uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN || github.token }}
          user: javier25arroyo
          template: classic
          filename: assets/github-achievements.svg
          base: metadata
          config_timezone: America/Costa_Rica
          plugin_achievements: yes
          plugin_achievements_threshold: C
          plugin_achievements_display: detailed
